{% extends "base.html" %}
{% block content %}
<div class="container" style="margin-top:18px">
  <h2 class="page-title">Products</h2>

  <div class="controls">
    <input class="search" type="text" name="q" placeholder="search" value="{{ q|default('') }}">
    <input class="filter" type="text" name="brand" placeholder="brand" value="{{ brand|default('') }}">
    <a class="btn btn-outline" href="{{ url_for('products') }}">Search</a>
    <div style="margin-left:auto">
      <a class="btn btn-primary" href="{{ url_for('show_qr') }}">Show QR</a>
    </div>
  </div>

  <div class="table-wrap">
    <table class="products-table">
      <thead>
        <tr>
          <th>SKU</th><th>Name</th><th>Brand</th><th>Price</th><th>Stock</th><th>Aisle</th><th style="width:180px">Add to list</th>
        </tr>
      </thead>
      <tbody>
        {% for p in products %}
        <tr>
          <td>{{ p.sku }}</td>
          <td><strong>{{ p.name }}</strong><small>{{ p.size }}</small></td>
          <td>{{ p.brand }}</td>
          <td>₹{{ '%.2f'|format(p.price) }}</td>
          <td>
            {% if p.availability == 'Out of stock' %}
              <span class="badge-out">Out of stock</span>
            {% else %}
              <span class="badge-available">In stock</span>
            {% endif %}
          </td>
          <td>{{ p.aisle }}</td>
          <td>
            <form method="post" action="{{ url_for('add_to_list') }}" style="display:flex;gap:8px;align-items:center">
              <input type="hidden" name="sku" value="{{ p.sku }}">
              <input class="qty" type="number" name="qty" value="1" min="1">
              <button class="add-btn" type="submit">Add to list</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- mobile cards -->
  <div class="card-grid" style="margin-top:16px">
    {% for p in products %}
      <div class="product-card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-weight:800">{{ p.name }}</div>
            <small style="color:#71886f">{{ p.brand }} • {{ p.size }}</small>
          </div>
          <div style="text-align:right;color:var(--olive-800);font-weight:800">₹{{ '%.2f'|format(p.price) }}</div>
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
          <div>
            {% if p.availability == 'Out of stock' %}
              <span class="badge-out">Out of stock</span>
            {% else %}
              <span class="badge-available">In stock</span>
            {% endif %}
          </div>
          <div>
            <form method="post" action="{{ url_for('add_to_list') }}" style="display:flex;gap:8px">
              <input type="hidden" name="sku" value="{{ p.sku }}">
              <input class="qty" type="number" name="qty" value="1" min="1">
              <button class="add-btn" type="submit">Add to list</button>
            </form>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

</div>
{% endblock %}
